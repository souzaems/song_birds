# Avian Comparative Genomics Pipeline

## Overview
This repository contains a bioinformatics pipeline designed for large-scale comparative genomics analysis across avian species and non-avian outgroups. The workflow automates the processing of Multiple Alignment Format (MAF) files to generate gene presence/absence matrices, facilitating the identification of lineage-specific gene losses and gains.

This pipeline was developed to analyze orthologous gene conservation using a reference-based approach, integrating tools for genomic interval intersection, statistical aggregation, and hierarchical clustering visualization.

**Note:** The biological data and specific results generated using this pipeline are currently unpublished. This repository hosts the methodological scripts only.

## Pipeline Architecture

The analysis workflow is divided into three main stages:

### 1. Data Processing & Intersection (`run_analysis.sh`)
This High-Performance Computing (HPC) workflow, managed via Slurm, performs the following:
* **Parsing:** Extracts alignment blocks from multi-gigabyte `.maf` files (generated by Cactus/HAL tools).
* **Filtering:** Filters blocks based on a specific reference genome (e.g., *Taeniopygia guttata*).
* **Intersection:** Uses `bedtools` to map reference gene coordinates (GFF/BED) to aligned blocks across multiple species.
* **Matrix Generation:** Aggregates intersection data into a gene-by-species count matrix using custom AWK scripting (`matrix_builder.awk`).

### 2. Visualization (`plot_heatmap.R`)
An R-based module that:
* Converts count matrices into binary presence/absence data.
* Performs hierarchical clustering (Euclidean distance/Complete linkage) on both genes and species.
* Generates high-resolution heatmaps annotated with scientific species names.

### 3. Cluster Extraction (`export_clusters.R`)
A utility script to extract specific gene lists from the hierarchical clusters, allowing for the isolation of candidate genes that follow specific evolutionary patterns (e.g., clade-specific deletions).

## Dependencies

The pipeline requires a Linux environment with the following software:
* **Slurm Workload Manager** (for job submission)
* **Bedtools** (v2.30+)
* **AWK** (GNU awk recommended)
* **R** (v4.0+)
    * Package: `pheatmap`

## Usage

### Running the Analysis
The main wrapper script submits the job to the cluster partition:

```bash
sbatch scripts/run_analysis.sh
